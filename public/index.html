<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EvoChess - Multiplayer Evolution Chess on a Globe</title>
  <style>
    body { 
      margin: 0; 
      overflow: hidden; 
      background-color: #1a1a1a;
      font-family: Arial, sans-serif;
    }
    canvas { 
      display: block; 
    }
    @keyframes pulse {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      50% { transform: translate(-50%, -50%) scale(1.05); opacity: 0.8; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }
    #ui {
      position: absolute;
      top: 5px;
      left: 5px;
      color: white;
      z-index: 100;
      background: rgba(0, 0, 0, 0.5);
      padding: 5px;
      border-radius: 3px;
      font-size: 11px;
    }
    #connection-status {
      position: absolute;
      top: 5px;
      right: 5px;
      color: white;
      z-index: 100;
      background: rgba(0, 0, 0, 0.5);
      padding: 4px;
      border-radius: 3px;
      font-size: 9px;
    }
    #performance-info {
      position: absolute;
      top: 5px;
      right: 80px;
      color: white;
      z-index: 100;
      background: rgba(0, 0, 0, 0.5);
      padding: 4px;
      border-radius: 3px;
      font-size: 8px;
    }
    
    /* Loading animations */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Smooth transitions */
    * {
      transition: all 0.3s ease;
    }
    
    /* Enhanced tooltips */
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: rgba(0, 0, 0, 0.9);
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1000;
      bottom: 125%;
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      border: 1px solid #444;
    }
    
    .tooltip .tooltiptext::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #000 transparent transparent transparent;
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    
    /* Button hover effects */
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }
    
    /* Enhanced focus states */
    button:focus, input:focus, select:focus {
      outline: 2px solid #3498db;
      outline-offset: 2px;
    }
    
    /* Color selector styles */
    .color-option {
      width: 20px;
      height: 20px;
      border: 2px solid #444;
      border-radius: 3px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #fff;
      text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
    }
    
    .color-option:hover {
      border-color: #fff;
      transform: scale(1.1);
    }
    
    .color-option.selected {
      border-color: #fff;
      box-shadow: 0 0 6px rgba(255, 255, 255, 0.7);
    }
    
    .color-option.unavailable {
      opacity: 0.4;
      cursor: not-allowed;
      position: relative;
    }
    
    .color-option.unavailable::after {
      content: "‚úñ";
      position: absolute;
      font-size: 12px;
      color: #fff;
      text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.8);
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      #ui {
        font-size: 12px;
        padding: 8px;
        max-width: 250px;
      }
      
      #connection-status {
        font-size: 12px;
        padding: 8px;
        top: 5px;
        right: 5px;
      }
      
      #performance-info {
        font-size: 10px;
        padding: 5px;
        top: 5px;
        right: 120px;
      }
      
      #timing-ui {
        font-size: 12px;
        padding: 8px;
        top: 5px;
        right: 5px;
        min-width: 150px;
      }
      
      #chat-ui {
        bottom: 5px;
        left: 5px;
        width: calc(100% - 10px);
        max-width: 350px;
      }
      
      button {
        padding: 8px 12px;
        font-size: 12px;
      }
    }
    
    @media (max-width: 480px) {
      #ui {
        font-size: 11px;
        padding: 5px;
        max-width: 200px;
      }
      
      #performance-info {
        display: none; /* Hide on very small screens */
      }
      
      #timing-ui {
        font-size: 11px;
        padding: 5px;
        min-width: 120px;
      }
      
      #chat-ui {
        max-width: 280px;
        font-size: 11px;
      }
      
      button {
        padding: 6px 10px;
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <div id="ui">
    <h3 style="font-size: 14px; margin: 0 0 5px 0;">Globe Chess</h3>
          <div id="player-count">Players: 0</div>
      <div id="game-info">Waiting for players...</div>
      <button id="add-ai-btn" style="
        margin-top: 10px;
        padding: 5px 10px;
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
        font-size: 12px;
      ">Add AI Player</button>
<div id="mode-indicator" style="
  position: absolute;
  top: 60px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 5px 15px;
  border-radius: 20px;
  font-size: 14px;
  z-index: 1000;
  display: none;
  border: 2px solid #00ff00;
">Camera Mode (Press S to switch)</div>
    <div id="color-selector" style="margin-top: 10px; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
      <div style="font-size: 10px; color: #ccc; margin-bottom: 5px;">Your Color:</div>
      <div id="color-options" style="display: flex; flex-wrap: wrap; gap: 3px;">
        <!-- Color options will be populated by JavaScript -->
      </div>
      <div id="selected-color" style="margin-top: 5px; font-size: 9px; color: #aaa;">None selected</div>
    </div>
    <div style="margin-top: 5px;">
      <button id="lobby-toggle" style="padding: 2px 6px; background: #00aaff; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px;">üè† Lobby System</button>
      <button id="evolution-toggle" style="padding: 2px 6px; background: #6600cc; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px; margin-left: 3px;">üß¨ Evolution</button>
      <button id="stats-toggle" style="padding: 2px 6px; background: #cc00cc; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px; margin-left: 3px;">üìä Statistics</button>
      <button id="tournament-toggle" style="padding: 2px 6px; background: #4444ff; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px; margin-left: 3px;">üèÜ Tournament Mode</button>
      <button id="spectator-toggle" style="padding: 2px 6px; background: #ff6600; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px; margin-left: 3px;">üëÅÔ∏è Spectator Mode</button>
      <button id="replay-toggle" style="padding: 2px 6px; background: #9900cc; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px; margin-left: 3px;">üì∫ Replays</button>
      <button id="ai-toggle" style="padding: 2px 6px; background: #00cc66; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px; margin-left: 3px;">ü§ñ AI Opponents</button>
      <button id="quit-game" style="padding: 2px 6px; background: #ff4444; color: #fff; border: none; border-radius: 2px; cursor: pointer; font-size: 9px; margin-left: 3px;">üö™ Quit Game</button>
    </div>
    <div id="dual-movement-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 5px;">
      <div style="font-size: 14px; margin-bottom: 5px; color: #ffd700;">Hybrid Queen Movement:</div>
      <div style="display: flex; gap: 10px;">
        <button id="queen-mode-btn" style="padding: 5px 10px; background: #ffd700; color: #000; border: none; border-radius: 3px; cursor: pointer;">Queen Mode</button>
        <button id="jumper-mode-btn" style="padding: 5px 10px; background: #ff6600; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Jumper Mode</button>
      </div>
      <div style="font-size: 12px; margin-top: 5px; color: #ccc;">
        <span id="mode-description">Click a mode to see movement options</span>
      </div>
    </div>
    
    <div id="tournament-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 100, 0.3); border-radius: 5px; border: 1px solid #4444ff;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #4444ff;">üèÜ Tournament Mode</div>
      <div id="tournament-lobby" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="create-tournament-btn" style="padding: 5px 10px; background: #4444ff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create Tournament</button>
          <button id="join-tournament-btn" style="padding: 5px 10px; background: #44ff44; color: #000; border: none; border-radius: 3px; cursor: pointer;">Join Tournament</button>
        </div>
        <div id="tournament-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No tournaments available</div>
        </div>
      </div>
      
      <div id="tournament-creation" style="display: none;">
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Tournament Name:</label>
          <input id="tournament-name" type="text" placeholder="Enter tournament name" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Max Players:</label>
          <select id="tournament-max-players" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="2">2 Players</option>
            <option value="4">4 Players</option>
            <option value="8" selected>8 Players</option>
          </select>
        </div>
        <div style="display: flex; gap: 10px;">
          <button id="create-tournament-confirm" style="padding: 5px 10px; background: #4444ff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create</button>
          <button id="create-tournament-cancel" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Cancel</button>
        </div>
      </div>
      
      <div id="tournament-status" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div id="tournament-info" style="color: #ccc; font-size: 12px;">Tournament Status</div>
        <div id="tournament-brackets" style="margin-top: 10px; color: #ccc; font-size: 11px;">Brackets will appear here</div>
      </div>
    </div>
    
    <div id="lobby-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 100, 150, 0.3); border-radius: 5px; border: 1px solid #00aaff;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #00aaff;">üè† Lobby System</div>
      <div id="lobby-browser" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="create-lobby-btn" style="padding: 5px 10px; background: #00aaff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create Lobby</button>
          <button id="refresh-lobbies-btn" style="padding: 5px 10px; background: #0088cc; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Refresh</button>
        </div>
        <div id="lobby-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No lobbies available</div>
        </div>
      </div>
      
      <div id="lobby-creation" style="display: none;">
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Lobby Name:</label>
          <input id="lobby-name" type="text" placeholder="Enter lobby name" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Max Players:</label>
          <select id="lobby-max-players" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="2">2 Players</option>
            <option value="3">3 Players</option>
            <option value="4">4 Players</option>
            <option value="6">6 Players</option>
            <option value="8" selected>8 Players</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Game Mode:</label>
          <select id="lobby-game-mode" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="standard" selected>Standard</option>
            <option value="blitz">Blitz</option>
            <option value="custom">Custom</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Time Limit (seconds):</label>
          <input id="lobby-time-limit" type="number" min="1" max="30" value="7" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
        </div>
        <div style="display: flex; gap: 10px;">
          <button id="create-lobby-confirm" style="padding: 5px 10px; background: #00aaff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create</button>
          <button id="create-lobby-cancel" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Cancel</button>
        </div>
      </div>
      
      <div id="lobby-room" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <div id="lobby-room-name" style="color: #00aaff; font-size: 14px; font-weight: bold;">Lobby Name</div>
          <button id="leave-lobby-btn" style="padding: 3px 8px; background: #cc0000; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">Leave</button>
        </div>
        <div id="lobby-players" style="margin-bottom: 10px;">
          <div style="color: #ccc; font-size: 12px; margin-bottom: 5px;">Players:</div>
          <div id="lobby-players-list" style="color: #fff; font-size: 11px;"></div>
        </div>
        <div id="lobby-settings" style="margin-bottom: 10px; padding: 5px; background: rgba(0, 0, 0, 0.2); border-radius: 3px;">
          <div style="color: #ccc; font-size: 12px; margin-bottom: 5px;">Settings:</div>
          <div id="lobby-settings-display" style="color: #fff; font-size: 11px;"></div>
        </div>
        <div style="display: flex; gap: 10px; align-items: center;">
          <button id="ready-toggle-btn" style="padding: 5px 15px; background: #ff6600; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Ready</button>
          <div id="ready-status" style="color: #ccc; font-size: 12px;">Not Ready</div>
        </div>
        <div id="game-starting-countdown" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 150, 0, 0.3); border-radius: 3px; text-align: center;">
          <div style="color: #00ff00; font-size: 14px; font-weight: bold;">Game Starting in: <span id="countdown-timer">3</span></div>
        </div>
             </div>
     </div>
     
     <div id="stats-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(150, 0, 150, 0.3); border-radius: 5px; border: 1px solid #cc00cc;">
       <div style="font-size: 14px; margin-bottom: 10px; color: #cc00cc;">üìä Statistics & Leaderboards</div>
       <div style="display: flex; gap: 10px; margin-bottom: 10px;">
         <button id="show-personal-stats" style="padding: 5px 10px; background: #cc00cc; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">My Stats</button>
         <button id="show-leaderboard" style="padding: 5px 10px; background: #aa00aa; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Leaderboard</button>
         <button id="show-achievements" style="padding: 5px 10px; background: #8800aa; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Achievements</button>
         <button id="show-global-stats" style="padding: 5px 10px; background: #6600aa; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Global</button>
       </div>
       
       <div id="personal-stats" style="display: block;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Personal Statistics</div>
         <div id="personal-stats-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading personal statistics...</div>
         </div>
       </div>
       
       <div id="leaderboard" style="display: none;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Leaderboard</div>
         <div style="display: flex; gap: 5px; margin-bottom: 8px;">
           <select id="leaderboard-category" style="padding: 3px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px; font-size: 10px;">
             <option value="rating">Rating</option>
             <option value="wins">Wins</option>
             <option value="winRate">Win Rate</option>
             <option value="battles">Battles Won</option>
             <option value="evolution">Evolutions</option>
             <option value="tournaments">Tournaments</option>
           </select>
           <button id="refresh-leaderboard" style="padding: 3px 8px; background: #cc00cc; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">Refresh</button>
         </div>
         <div id="leaderboard-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading leaderboard...</div>
         </div>
       </div>
       
       <div id="achievements" style="display: none;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Achievements</div>
         <div id="achievements-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading achievements...</div>
         </div>
       </div>
       
       <div id="global-stats" style="display: none;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Global Statistics</div>
         <div id="global-stats-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading global statistics...</div>
         </div>
             </div>
    </div>
    
    <div id="evolution-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(100, 0, 200, 0.3); border-radius: 5px; border: 1px solid #6600cc;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #6600cc;">üß¨ Evolution System</div>
      <div id="evolution-bank" style="margin-bottom: 10px; padding: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div style="color: #6600cc; font-size: 12px; margin-bottom: 5px;">Evolution Bank</div>
        <div style="display: flex; justify-content: space-between; color: #fff; font-size: 11px;">
          <span>Available Points: <span id="evolution-points">0</span></span>
          <span>Total Earned: <span id="evolution-total-earned">0</span></span>
        </div>
      </div>
      
      <div id="evolution-choice-panel" style="display: none; margin-bottom: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px; border: 1px solid #6600cc;">
        <div style="color: #6600cc; font-size: 13px; margin-bottom: 8px;">Choose Evolution Path</div>
        <div id="evolution-piece-info" style="margin-bottom: 8px; color: #fff; font-size: 11px;">
          <span id="evolution-piece-name">Piece</span> - <span id="evolution-piece-age">Age: 0s</span>
        </div>
        <div id="evolution-paths" style="margin-bottom: 8px;">
          <!-- Evolution paths will be populated here -->
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <div id="evolution-timer" style="color: #ff6600; font-size: 10px;">Time left: 30s</div>
          <button id="cancel-evolution" style="padding: 3px 8px; background: #cc0000; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">Cancel</button>
        </div>
      </div>
      
      <div id="evolution-controls" style="display: flex; gap: 10px; margin-bottom: 10px;">
        <button id="refresh-evolution-bank" style="padding: 5px 10px; background: #6600cc; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Refresh Bank</button>
        <button id="show-evolution-help" style="padding: 5px 10px; background: #4400aa; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Help</button>
      </div>
      
      <div id="evolution-help" style="display: none; padding: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 3px; color: #ccc; font-size: 10px;">
        <div style="color: #6600cc; font-weight: bold; margin-bottom: 5px;">Evolution System Guide:</div>
        <div>‚Ä¢ Right-click pieces to see available evolution paths</div>
        <div>‚Ä¢ Different pieces have different evolution costs and time requirements</div>
        <div>‚Ä¢ Pieces must survive for a certain time to unlock advanced evolutions</div>
        <div>‚Ä¢ Some evolutions require battle experience or special achievements</div>
        <div>‚Ä¢ You have 30 seconds to choose when evolution options appear</div>
      </div>
    </div>
    
    <div id="spectator-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(100, 50, 0, 0.3); border-radius: 5px; border: 1px solid #ff6600;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #ff6600;">üëÅÔ∏è Spectator Mode</div>
      <div id="spectator-lobby" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="join-spectator-btn" style="padding: 5px 10px; background: #ff6600; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Join as Spectator</button>
          <button id="leave-spectator-btn" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer; display: none;">Leave Spectator</button>
        </div>
        <div id="spectator-info" style="color: #ccc; font-size: 12px; margin-bottom: 10px;">
          <div>Spectator Count: <span id="spectator-count">0</span></div>
          <div>Game Status: <span id="spectator-game-status">Waiting</span></div>
        </div>
        <div id="spectator-games-list" style="max-height: 150px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No games available to spectate</div>
        </div>
      </div>
    </div>
    
    <div id="replay-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(100, 0, 100, 0.3); border-radius: 5px; border: 1px solid #9900cc;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #9900cc;">üì∫ Replay System</div>
      <div id="replay-lobby" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="refresh-replays-btn" style="padding: 5px 10px; background: #9900cc; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Refresh Replays</button>
          <button id="stop-replay-btn" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer; display: none;">Stop Replay</button>
        </div>
        <div id="replay-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No replays available</div>
        </div>
      </div>
      
      <div id="replay-controls" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
          <button id="replay-play-pause" style="padding: 5px 10px; background: #9900cc; color: #fff; border: none; border-radius: 3px; cursor: pointer;">‚ñ∂Ô∏è</button>
          <button id="replay-step-back" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">‚èÆÔ∏è</button>
          <button id="replay-step-forward" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">‚è≠Ô∏è</button>
          <span style="color: #ccc; font-size: 12px;">Speed:</span>
          <select id="replay-speed" style="padding: 3px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="0.5">0.5x</option>
            <option value="1" selected>1x</option>
            <option value="1.5">1.5x</option>
            <option value="2">2x</option>
            <option value="4">4x</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <div style="display: flex; justify-content: space-between; color: #ccc; font-size: 11px;">
            <span>Move: <span id="replay-current-move">0</span>/<span id="replay-total-moves">0</span></span>
            <span>Time: <span id="replay-current-time">0:00</span>/<span id="replay-total-time">0:00</span></span>
          </div>
          <input type="range" id="replay-timeline" min="0" max="100" value="0" style="width: 100%; margin-top: 5px;">
        </div>
        <div id="replay-info" style="color: #ccc; font-size: 11px;">
          <div>Game: <span id="replay-game-id">-</span></div>
          <div>Players: <span id="replay-players">-</span></div>
          <div>Duration: <span id="replay-duration">-</span></div>
        </div>
      </div>
    </div>
    
    <div id="ai-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 100, 50, 0.3); border-radius: 5px; border: 1px solid #00cc66;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #00cc66;">ü§ñ AI Opponents</div>
      <div id="ai-controls" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="add-ai-btn" style="padding: 5px 10px; background: #00cc66; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Add AI Player</button>
          <button id="remove-all-ai-btn" style="padding: 5px 10px; background: #cc0000; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Remove All AI</button>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">AI Difficulty:</label>
          <select id="ai-difficulty-select" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="EASY">Easy - Simple moves with randomness</option>
            <option value="MEDIUM" selected>Medium - Balanced strategy</option>
            <option value="HARD">Hard - Strategic planning</option>
            <option value="EXPERT">Expert - Advanced analysis</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">AI Personality:</label>
          <select id="ai-personality-select" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="balanced">Balanced - Well-rounded strategy</option>
            <option value="aggressive">Aggressive - Prefers attacks</option>
            <option value="defensive">Defensive - Cautious play</option>
            <option value="evolution">Evolution-focused - Prioritizes upgrades</option>
          </select>
        </div>
      </div>
      
      <div id="ai-players-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
        <div style="color: #888; font-size: 12px;">No AI players active</div>
      </div>
      
      <div id="ai-stats" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div style="font-size: 12px; color: #ccc; margin-bottom: 5px;">AI Statistics</div>
        <div id="ai-stats-content" style="color: #ccc; font-size: 11px;">
          <div>Moves Played: <span id="ai-moves-played">0</span></div>
          <div>Battles Won: <span id="ai-battles-won">0</span></div>
          <div>Battles Lost: <span id="ai-battles-lost">0</span></div>
          <div>Pieces Evolved: <span id="ai-pieces-evolved">0</span></div>
          <div>Avg Think Time: <span id="ai-avg-think-time">0ms</span></div>
        </div>
      </div>
    </div>
  </div>
  
  <div id="connection-status">
    <div id="status">Connecting...</div>
  </div>
  
  <div id="performance-info">
    <div>Performance Monitor</div>
    <div>FPS: 0</div>
    <div>Memory: 0MB</div>
    <div>Objects: 0</div>
    <div>Pieces: 0</div>
  </div>

  <!-- Timing UI -->
  <div id="timing-ui" style="position: absolute; top: 5px; right: 120px; color: white; z-index: 100; background: rgba(0, 0, 0, 0.8); padding: 6px; border-radius: 3px; border: 1px solid #ff6600; min-width: 120px;">
    <div style="font-size: 10px; margin-bottom: 4px; color: #ff6600; text-align: center;">üïí Move Timer</div>
    <div id="active-player-info" style="margin-bottom: 4px; text-align: center; color: #ccc; font-size: 9px;">
      Turn: <span id="active-player-name" style="color: #fff; font-weight: bold;">-</span>
    </div>
    <div id="timer-display" style="margin-bottom: 4px;">
      <div id="timer-bar-container" style="width: 100%; height: 12px; background: #333; border-radius: 6px; overflow: hidden; margin-bottom: 3px;">
        <div id="timer-bar" style="height: 100%; background: linear-gradient(90deg, #00ff00, #ffff00, #ff6600, #ff0000); width: 100%; transition: width 0.1s linear; border-radius: 6px;"></div>
      </div>
      <div id="timer-text" style="text-align: center; font-size: 12px; font-weight: bold; color: #fff;">
        <span id="time-remaining">7.0</span>s
      </div>
    </div>
    <div id="timer-status" style="text-align: center; font-size: 8px; color: #ccc;">
      Waiting for game to start...
    </div>
    <div id="turn-queue" style="margin-top: 4px; font-size: 8px; color: #888;">
      <div style="color: #ccc;">Turn Queue:</div>
      <div id="turn-queue-list" style="margin-top: 2px;">-</div>
    </div>
  </div>

  <!-- Chat UI -->
  <div id="chat-ui" style="position: absolute; bottom: 5px; left: 5px; color: white; z-index: 100; background: rgba(0, 0, 0, 0.8); padding: 6px; border-radius: 3px; border: 1px solid #00cc88; width: 200px; height: 150px; display: flex; flex-direction: column;">
    <div style="font-size: 9px; margin-bottom: 4px; color: #00cc88; text-align: center; display: flex; justify-content: space-between; align-items: center;">
      <span>üí¨ Game Chat</span>
      <button id="toggle-chat" style="background: #00cc88; color: #000; border: none; padding: 1px 3px; border-radius: 2px; cursor: pointer; font-size: 8px;">Hide</button>
    </div>
    <div id="chat-messages" style="flex: 1; overflow-y: auto; background: rgba(0, 0, 0, 0.5); padding: 4px; border-radius: 3px; margin-bottom: 4px; font-size: 8px; border: 1px solid #333;">
      <div style="color: #888; text-align: center; font-style: italic;">Chat messages will appear here...</div>
    </div>
    <div id="chat-input-container" style="display: flex; gap: 3px;">
      <input id="chat-input" type="text" placeholder="Type a message..." style="flex: 1; padding: 3px; background: #333; color: #fff; border: 1px solid #555; border-radius: 2px; font-size: 8px;" maxlength="200">
      <button id="send-chat" style="background: #00cc88; color: #000; border: none; padding: 3px 6px; border-radius: 2px; cursor: pointer; font-size: 8px;">Send</button>
    </div>
    <div id="chat-status" style="font-size: 7px; color: #888; margin-top: 2px; text-align: center;">
      Connected to Game Chat
    </div>
  </div>

  <!-- Load Three.js, Controls, and GLTFLoader via script tags -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/TrackballControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  
  <!-- Initialize GLTFLoader when scripts are loaded -->
  <script>
    window.addEventListener('load', function() {
      console.log('Window loaded - checking Three.js components...');
      console.log('THREE available:', typeof THREE !== 'undefined');
      console.log('OrbitControls available:', typeof THREE.OrbitControls !== 'undefined');
      console.log('TrackballControls available:', typeof THREE.TrackballControls !== 'undefined');
      console.log('GLTFLoader available:', typeof THREE.GLTFLoader !== 'undefined');
      
      if (typeof THREE.GLTFLoader === 'undefined') {
        console.error('GLTFLoader not loaded! Models will use geometric fallbacks.');
      }
    });
  </script>
      <script src="./main-simple.js?v=23&debug=true"></script>
</body>
</html> 