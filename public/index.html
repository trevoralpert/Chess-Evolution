<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multiplayer Globe Chess</title>
  <style>
    body { 
      margin: 0; 
      overflow: hidden; 
      background-color: #1a1a1a;
      font-family: Arial, sans-serif;
    }
    canvas { 
      display: block; 
    }
    @keyframes pulse {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      50% { transform: translate(-50%, -50%) scale(1.05); opacity: 0.8; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }
    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      z-index: 100;
      background: rgba(0, 0, 0, 0.5);
      padding: 10px;
      border-radius: 5px;
    }
    #connection-status {
      position: absolute;
      top: 10px;
      right: 10px;
      color: white;
      z-index: 100;
      background: rgba(0, 0, 0, 0.5);
      padding: 10px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div id="ui">
    <h3>Globe Chess</h3>
    <div id="player-count">Players: 0</div>
    <div id="game-info">Waiting for players...</div>
    <div style="margin-top: 10px;">
      <button id="lobby-toggle" style="padding: 5px 10px; background: #00aaff; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 12px;">🏠 Lobby System</button>
      <button id="stats-toggle" style="padding: 5px 10px; background: #cc00cc; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 12px; margin-left: 5px;">📊 Statistics</button>
      <button id="tournament-toggle" style="padding: 5px 10px; background: #4444ff; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 12px; margin-left: 5px;">🏆 Tournament Mode</button>
      <button id="spectator-toggle" style="padding: 5px 10px; background: #ff6600; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 12px; margin-left: 5px;">👁️ Spectator Mode</button>
      <button id="replay-toggle" style="padding: 5px 10px; background: #9900cc; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 12px; margin-left: 5px;">📺 Replays</button>
      <button id="ai-toggle" style="padding: 5px 10px; background: #00cc66; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 12px; margin-left: 5px;">🤖 AI Opponents</button>
    </div>
    <div id="dual-movement-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 5px;">
      <div style="font-size: 14px; margin-bottom: 5px; color: #ffd700;">Hybrid Queen Movement:</div>
      <div style="display: flex; gap: 10px;">
        <button id="queen-mode-btn" style="padding: 5px 10px; background: #ffd700; color: #000; border: none; border-radius: 3px; cursor: pointer;">Queen Mode</button>
        <button id="jumper-mode-btn" style="padding: 5px 10px; background: #ff6600; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Jumper Mode</button>
      </div>
      <div style="font-size: 12px; margin-top: 5px; color: #ccc;">
        <span id="mode-description">Click a mode to see movement options</span>
      </div>
    </div>
    
    <div id="tournament-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 100, 0.3); border-radius: 5px; border: 1px solid #4444ff;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #4444ff;">🏆 Tournament Mode</div>
      <div id="tournament-lobby" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="create-tournament-btn" style="padding: 5px 10px; background: #4444ff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create Tournament</button>
          <button id="join-tournament-btn" style="padding: 5px 10px; background: #44ff44; color: #000; border: none; border-radius: 3px; cursor: pointer;">Join Tournament</button>
        </div>
        <div id="tournament-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No tournaments available</div>
        </div>
      </div>
      
      <div id="tournament-creation" style="display: none;">
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Tournament Name:</label>
          <input id="tournament-name" type="text" placeholder="Enter tournament name" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Max Players:</label>
          <select id="tournament-max-players" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="2">2 Players</option>
            <option value="4">4 Players</option>
            <option value="8" selected>8 Players</option>
          </select>
        </div>
        <div style="display: flex; gap: 10px;">
          <button id="create-tournament-confirm" style="padding: 5px 10px; background: #4444ff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create</button>
          <button id="create-tournament-cancel" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Cancel</button>
        </div>
      </div>
      
      <div id="tournament-status" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div id="tournament-info" style="color: #ccc; font-size: 12px;">Tournament Status</div>
        <div id="tournament-brackets" style="margin-top: 10px; color: #ccc; font-size: 11px;">Brackets will appear here</div>
      </div>
    </div>
    
    <div id="lobby-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 100, 150, 0.3); border-radius: 5px; border: 1px solid #00aaff;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #00aaff;">🏠 Lobby System</div>
      <div id="lobby-browser" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="create-lobby-btn" style="padding: 5px 10px; background: #00aaff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create Lobby</button>
          <button id="refresh-lobbies-btn" style="padding: 5px 10px; background: #0088cc; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Refresh</button>
        </div>
        <div id="lobby-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No lobbies available</div>
        </div>
      </div>
      
      <div id="lobby-creation" style="display: none;">
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Lobby Name:</label>
          <input id="lobby-name" type="text" placeholder="Enter lobby name" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Max Players:</label>
          <select id="lobby-max-players" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="2">2 Players</option>
            <option value="3">3 Players</option>
            <option value="4">4 Players</option>
            <option value="6">6 Players</option>
            <option value="8" selected>8 Players</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Game Mode:</label>
          <select id="lobby-game-mode" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="standard" selected>Standard</option>
            <option value="blitz">Blitz</option>
            <option value="custom">Custom</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">Time Limit (seconds):</label>
          <input id="lobby-time-limit" type="number" min="1" max="30" value="7" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
        </div>
        <div style="display: flex; gap: 10px;">
          <button id="create-lobby-confirm" style="padding: 5px 10px; background: #00aaff; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Create</button>
          <button id="create-lobby-cancel" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Cancel</button>
        </div>
      </div>
      
      <div id="lobby-room" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <div id="lobby-room-name" style="color: #00aaff; font-size: 14px; font-weight: bold;">Lobby Name</div>
          <button id="leave-lobby-btn" style="padding: 3px 8px; background: #cc0000; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">Leave</button>
        </div>
        <div id="lobby-players" style="margin-bottom: 10px;">
          <div style="color: #ccc; font-size: 12px; margin-bottom: 5px;">Players:</div>
          <div id="lobby-players-list" style="color: #fff; font-size: 11px;"></div>
        </div>
        <div id="lobby-settings" style="margin-bottom: 10px; padding: 5px; background: rgba(0, 0, 0, 0.2); border-radius: 3px;">
          <div style="color: #ccc; font-size: 12px; margin-bottom: 5px;">Settings:</div>
          <div id="lobby-settings-display" style="color: #fff; font-size: 11px;"></div>
        </div>
        <div style="display: flex; gap: 10px; align-items: center;">
          <button id="ready-toggle-btn" style="padding: 5px 15px; background: #ff6600; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Ready</button>
          <div id="ready-status" style="color: #ccc; font-size: 12px;">Not Ready</div>
        </div>
        <div id="game-starting-countdown" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 150, 0, 0.3); border-radius: 3px; text-align: center;">
          <div style="color: #00ff00; font-size: 14px; font-weight: bold;">Game Starting in: <span id="countdown-timer">3</span></div>
        </div>
             </div>
     </div>
     
     <div id="stats-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(150, 0, 150, 0.3); border-radius: 5px; border: 1px solid #cc00cc;">
       <div style="font-size: 14px; margin-bottom: 10px; color: #cc00cc;">📊 Statistics & Leaderboards</div>
       <div style="display: flex; gap: 10px; margin-bottom: 10px;">
         <button id="show-personal-stats" style="padding: 5px 10px; background: #cc00cc; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">My Stats</button>
         <button id="show-leaderboard" style="padding: 5px 10px; background: #aa00aa; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Leaderboard</button>
         <button id="show-achievements" style="padding: 5px 10px; background: #8800aa; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Achievements</button>
         <button id="show-global-stats" style="padding: 5px 10px; background: #6600aa; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Global</button>
       </div>
       
       <div id="personal-stats" style="display: block;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Personal Statistics</div>
         <div id="personal-stats-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading personal statistics...</div>
         </div>
       </div>
       
       <div id="leaderboard" style="display: none;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Leaderboard</div>
         <div style="display: flex; gap: 5px; margin-bottom: 8px;">
           <select id="leaderboard-category" style="padding: 3px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px; font-size: 10px;">
             <option value="rating">Rating</option>
             <option value="wins">Wins</option>
             <option value="winRate">Win Rate</option>
             <option value="battles">Battles Won</option>
             <option value="evolution">Evolutions</option>
             <option value="tournaments">Tournaments</option>
           </select>
           <button id="refresh-leaderboard" style="padding: 3px 8px; background: #cc00cc; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">Refresh</button>
         </div>
         <div id="leaderboard-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading leaderboard...</div>
         </div>
       </div>
       
       <div id="achievements" style="display: none;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Achievements</div>
         <div id="achievements-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading achievements...</div>
         </div>
       </div>
       
       <div id="global-stats" style="display: none;">
         <div style="color: #cc00cc; font-size: 13px; margin-bottom: 8px;">Global Statistics</div>
         <div id="global-stats-content" style="color: #fff; font-size: 11px; max-height: 250px; overflow-y: auto; padding: 5px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
           <div style="color: #888;">Loading global statistics...</div>
         </div>
       </div>
     </div>
     
     <div id="spectator-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(100, 50, 0, 0.3); border-radius: 5px; border: 1px solid #ff6600;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #ff6600;">👁️ Spectator Mode</div>
      <div id="spectator-lobby" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="join-spectator-btn" style="padding: 5px 10px; background: #ff6600; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Join as Spectator</button>
          <button id="leave-spectator-btn" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer; display: none;">Leave Spectator</button>
        </div>
        <div id="spectator-info" style="color: #ccc; font-size: 12px; margin-bottom: 10px;">
          <div>Spectator Count: <span id="spectator-count">0</span></div>
          <div>Game Status: <span id="spectator-game-status">Waiting</span></div>
        </div>
        <div id="spectator-games-list" style="max-height: 150px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No games available to spectate</div>
        </div>
      </div>
    </div>
    
    <div id="replay-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(100, 0, 100, 0.3); border-radius: 5px; border: 1px solid #9900cc;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #9900cc;">📺 Replay System</div>
      <div id="replay-lobby" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="refresh-replays-btn" style="padding: 5px 10px; background: #9900cc; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Refresh Replays</button>
          <button id="stop-replay-btn" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer; display: none;">Stop Replay</button>
        </div>
        <div id="replay-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
          <div style="color: #888; font-size: 12px;">No replays available</div>
        </div>
      </div>
      
      <div id="replay-controls" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
          <button id="replay-play-pause" style="padding: 5px 10px; background: #9900cc; color: #fff; border: none; border-radius: 3px; cursor: pointer;">▶️</button>
          <button id="replay-step-back" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">⏮️</button>
          <button id="replay-step-forward" style="padding: 5px 10px; background: #666; color: #fff; border: none; border-radius: 3px; cursor: pointer;">⏭️</button>
          <span style="color: #ccc; font-size: 12px;">Speed:</span>
          <select id="replay-speed" style="padding: 3px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="0.5">0.5x</option>
            <option value="1" selected>1x</option>
            <option value="1.5">1.5x</option>
            <option value="2">2x</option>
            <option value="4">4x</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <div style="display: flex; justify-content: space-between; color: #ccc; font-size: 11px;">
            <span>Move: <span id="replay-current-move">0</span>/<span id="replay-total-moves">0</span></span>
            <span>Time: <span id="replay-current-time">0:00</span>/<span id="replay-total-time">0:00</span></span>
          </div>
          <input type="range" id="replay-timeline" min="0" max="100" value="0" style="width: 100%; margin-top: 5px;">
        </div>
        <div id="replay-info" style="color: #ccc; font-size: 11px;">
          <div>Game: <span id="replay-game-id">-</span></div>
          <div>Players: <span id="replay-players">-</span></div>
          <div>Duration: <span id="replay-duration">-</span></div>
        </div>
      </div>
    </div>
    
    <div id="ai-ui" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 100, 50, 0.3); border-radius: 5px; border: 1px solid #00cc66;">
      <div style="font-size: 14px; margin-bottom: 10px; color: #00cc66;">🤖 AI Opponents</div>
      <div id="ai-controls" style="display: block;">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <button id="add-ai-btn" style="padding: 5px 10px; background: #00cc66; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Add AI Player</button>
          <button id="remove-all-ai-btn" style="padding: 5px 10px; background: #cc0000; color: #fff; border: none; border-radius: 3px; cursor: pointer;">Remove All AI</button>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">AI Difficulty:</label>
          <select id="ai-difficulty-select" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="EASY">Easy - Simple moves with randomness</option>
            <option value="MEDIUM" selected>Medium - Balanced strategy</option>
            <option value="HARD">Hard - Strategic planning</option>
            <option value="EXPERT">Expert - Advanced analysis</option>
          </select>
        </div>
        <div style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 5px; color: #ccc;">AI Personality:</label>
          <select id="ai-personality-select" style="width: 100%; padding: 5px; background: #333; color: #fff; border: 1px solid #555; border-radius: 3px;">
            <option value="balanced">Balanced - Well-rounded strategy</option>
            <option value="aggressive">Aggressive - Prefers attacks</option>
            <option value="defensive">Defensive - Cautious play</option>
            <option value="evolution">Evolution-focused - Prioritizes upgrades</option>
          </select>
        </div>
      </div>
      
      <div id="ai-players-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #333; padding: 5px; border-radius: 3px; background: rgba(0, 0, 0, 0.3);">
        <div style="color: #888; font-size: 12px;">No AI players active</div>
      </div>
      
      <div id="ai-stats" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 3px;">
        <div style="font-size: 12px; color: #ccc; margin-bottom: 5px;">AI Statistics</div>
        <div id="ai-stats-content" style="color: #ccc; font-size: 11px;">
          <div>Moves Played: <span id="ai-moves-played">0</span></div>
          <div>Battles Won: <span id="ai-battles-won">0</span></div>
          <div>Battles Lost: <span id="ai-battles-lost">0</span></div>
          <div>Pieces Evolved: <span id="ai-pieces-evolved">0</span></div>
          <div>Avg Think Time: <span id="ai-avg-think-time">0ms</span></div>
        </div>
      </div>
    </div>
  </div>
  
  <div id="connection-status">
    <div id="status">Connecting...</div>
  </div>

  <!-- Load Three.js, OrbitControls, and GLTFLoader via script tags -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="./main-simple.js?v=15&debug=true"></script>
</body>
</html> 